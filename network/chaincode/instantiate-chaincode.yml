#
# SPDX-License-Identifier: Apache-2.0
#
---
    - name: Instantiate chaincode
      hosts: localhost
      vars_files:
        - ../vars/common.yml
        - ../vars/regulator-org.yml
      tasks:
        - name: Instantiate the chaincode on the channel
          ibm.blockchain_platform.instantiated_chaincode:
            api_endpoint: "{{ api_endpoint }}"
            api_authtype: "{{ api_authtype }}"
            api_key: "{{ api_key }}"
            api_secret: "{{ api_secret | default(omit) }}"
            api_token_endpoint: "{{ api_token_endpoint | default(omit) }}"
            peer: "{{ regulator_peer_name }}"
            identity: "../ouput/{{ regulator_name }}/Admin.json"
            msp_id: "{{ regulator_msp_id }}"
            channel: "{{ channel_name }}"
            name: "{{ smart_contract_name }}"
            constructor:
              function: "{{ smart_contract_constructor | default(omit) }}"
            version: "{{ smart_contract_version }}"
            endorsement_policy: "{{ smart_contract_endorsement_policy | default(omit) }}"
            collections_config: "{{ smart_contract_collections_file | default(omit) }}"
    